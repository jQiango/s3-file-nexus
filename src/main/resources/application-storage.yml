server:
  port: 8081
  servlet:
    context-path: /

spring:
  application:
    name: one-agent-4j-storage

  # 静态资源配置
  web:
    resources:
      static-locations: classpath:/static/
      add-mappings: true

  # MVC配置
  mvc:
    throw-exception-if-no-handler-found: false
    static-path-pattern: /**

  # 文件上传配置
  servlet:
    multipart:
      max-file-size: 100MB
      max-request-size: 100MB
      enabled: true

  # JSON序列化配置
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8

# 存储模块配置
storage:
  # 默认使用的存储后端（如果不使用动态配置，可以配置这里）
  default-backend: dynamic

  upload:
    max-file-size: 104857600  # 100MB
    temp-dir: /tmp/storage

  preview:
    enabled: true
    url-expiration: 3600  # 1小时
    enable-image-compression: true
    image-max-width: 1920
    image-max-height: 1080
    image-quality: 0.85

  security:
    enable-file-type-check: true
    enable-file-size-limit: true
    enable-filename-sanitization: true
    allowed-file-types:
      - jpg
      - jpeg
      - png
      - gif
      - bmp
      - webp
      - svg
      - pdf
      - doc
      - docx
      - xls
      - xlsx
      - ppt
      - pptx
      - txt
      - md
      - json
      - xml
      - yaml
      - yml
      - zip
      - rar
      - 7z
      - tar
      - gz
      - mp3
      - wav
      - ogg
      - flac
      - mp4
      - avi
      - mov
      - wmv
      - flv
      - webm
    forbidden-file-types:
      - exe
      - bat
      - cmd
      - com
      - pif
      - scr
      - jar
      - js
      - vbs
      - sh

  cache:
    enabled: true
    expiration: 300  # 5分钟
    max-entries: 1000
    cache-dir: /tmp/storage-cache

  # S3存储后端配置
  # dynamic 为动态配置的占位符，实际配置从前端传入
  backends:
    dynamic:
      name: Dynamic Config
      type: S3
      endpoint: ${S3_ENDPOINT:https://s3.amazonaws.com}
      access-key-id: ${S3_ACCESS_KEY:}
      access-key-secret: ${S3_SECRET_KEY:}
      region: ${S3_REGION:us-east-1}
      default-bucket: ${S3_DEFAULT_BUCKET:}
      enabled: true

# 日志配置
logging:
  level:
    com.all.in.one.agent.storage: DEBUG
    org.springframework.web: INFO
    software.amazon.awssdk: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n" 